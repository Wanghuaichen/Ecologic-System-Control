C51 COMPILER V9.00   INTERRUPT                                                             12/28/2017 15:24:07 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE INTERRUPT
OBJECT MODULE PLACED IN interrupt.OBJ
COMPILER INVOKED BY: C:\keil\C51\BIN\C51.EXE interrupt.c LARGE OPTIMIZE(8,SPEED) BROWSE INCDIR(.\SRC;.\I2C) DEBUG OBJECT
                    -EXTEND TABS(2)

line level    source

   1          #include"interrupt.h"
   2          /////*******************************************************************************
   3          //* 函 数 名         : Int1Init()
   4          //* 函数功能         : 设置外部中断1
   5          //* 输    入         : 无
   6          //* 输    出         : 无
   7          //*******************************************************************************/
   8          ////void Int0Init()
   9          ////{
  10          ////  //设置INT0
  11          ////  IT0=1;    //跳变沿出发方式（下降沿）
  12          ////  EX0=1;    //打开INT0的中断允许。  
  13          ////  EA=1;     //打开总中断  
  14          ////}
  15          
  16          /*******************************************************************************
  17          * 函 数 名         : Timer0Init
  18          * 函数功能         : 定时器0初始化
  19          * 输    入         : 无
  20          * 输    出         : 无
  21          * 定时时间计算     ：初值=0XFFFF-计数值+1
  22          *******************************************************************************/
  23          void Timer0Init()
  24          {
  25   1        TMOD|=0X01; //选择为定时器0模式，工作方式1，仅用TR0打开启动。
  26   1      
  27   1        TH0=0Xff;   //给定时器赋初值，定时1ms
  28   1        TL0=0Xb0; 
  29   1        ET0=1;      //打开定时器0中断允许
  30   1        EA=1;       //打开总中断
  31   1        TR0=1;      //打开定时器      
  32   1      }
  33          
  34          /*******************************************************************************
  35          * 函 数 名         : Int1Init()
  36          * 函数功能       : 设置外部中断1
  37          * 输    入         : 无
  38          * 输    出         : 无
  39          *******************************************************************************/
  40          ////void Int1Init()
  41          ////{
  42          ////  //设置INT1
  43          ////  IT1=1;    //跳变沿出发方式（下降沿）
  44          ////  EX1=1;    //打开INT1的中断允许。  
  45          ////  EA=1;     //打开总中断  
  46          ////}
  47          
  48          /*******************************************************************************
  49          * 函 数 名         : Timer1Init
  50          * 函数功能         : 定时器1初始化
  51          * 输    入         : 无
  52          * 输    出         : 无
  53          *******************************************************************************/
  54          ////void Timer1Init()
C51 COMPILER V9.00   INTERRUPT                                                             12/28/2017 15:24:07 PAGE 2   

  55          ////{
  56          ////  TMOD|=0X10;   //选择为定时器1模式，工作方式1，仅用TR1打开启动。
  57          ////  TH1=0XFC;     //给定时器赋初值，定时1ms
  58          ////  TL1=0X18; 
  59          ////  ET1=1;        //打开定时器1中断允许
  60          ////  EA=1;         //打开总中断
  61          ////  TR1=1;        //打开定时器      
  62          ////}
  63          
  64          /*******************************************************************************
  65          * 函数名         :UsartInit()
  66          * 函数功能       :设置串口
  67          * 输入           : 无
  68          * 输出           : 无
  69          *******************************************************************************/
  70          ////void UsartInit()
  71          ////{
  72          ////  SCON=0X50;      //设置为工作方式1
  73          ////  TMOD=0X20;      //设置计数器工作方式2
  74          ////  PCON=0X80;      //波特率加倍
  75          ////  TH1=0XF3;       //计数器初始值设置，注意波特率是4800的
  76          ////  TL1=0XF3;
  77          ////  ES=1;           //打开接收中断
  78          ////  EA=1;           //打开总中断
  79          ////  TR1=1;          //打开计数器
  80          ////}
  81           
  82          /*******************************************************************************
  83          * 函 数 名         : Int0() interrupt 0
  84          * 函数功能         : 外部中断0的中断函数
  85          * 输    入         : 无
  86          * 输    出         : 无
  87          *******************************************************************************/
  88          ////void Int0() interrupt 0   //外部中断0的中断函数
  89          ////{
  90          ////
  91          ////
  92          ////
  93          ////}
  94          
  95          /*******************************************************************************
  96          * 函 数 名         : void Timer0() interrupt 1
  97          * 函数功能         : 定时器0中断函数
  98          * 输    入         : 无
  99          * 输    出         : 无
 100          *******************************************************************************/
 101          void Timer0() interrupt 1
 102          {
 103   1        extern int led_num;
 104   1        extern int count_num;
 105   1        extern int key_ok_flag;
 106   1        extern int function_choose_flag;
 107   1        extern int led_replay;
 108   1        extern int pwm_num;
 109   1      
 110   1      //  TH0=0XFC;   //给定时器赋初值，定时1ms
 111   1      //  TL0=0X18;
 112   1      
 113   1        TH0=0xff;    //给定时器赋初值，定时80us
 114   1        TL0=0xb0;
 115   1      
 116   1         if(key_ok_flag==1&&function_choose_flag==1)
C51 COMPILER V9.00   INTERRUPT                                                             12/28/2017 15:24:07 PAGE 3   

 117   1        {
 118   2          count_num++;
 119   2        }
 120   1      
 121   1        if(led_replay==10)
 122   1        { 
 123   2          led_num++;
 124   2        }
 125   1        
 126   1        if(function_choose_flag==3)
 127   1        {
 128   2          pwm_num++;
 129   2        }
 130   1      }
 131          
 132          /*******************************************************************************
 133          * 函 数 名         : Int1() interrupt 2
 134          * 函数功能         : 外部中断0的中断函数
 135          * 输    入         : 无
 136          * 输    出         : 无
 137          *******************************************************************************/
 138          ////void Int1() interrupt 2   //外部中断1的中断函数
 139          ////{
 140          ////
 141          ////}
 142          
 143          /*******************************************************************************
 144          * 函 数 名         : void Timer1() interrupt 3
 145          * 函数功能       : 定时器0中断函数
 146          * 输    入         : 无
 147          * 输    出         : 无
 148          *******************************************************************************/
 149          ////void Timer1() interrupt 3
 150          ////{   
 151          //////  extern int count_num;
 152          ////  TH1=0XFC;     //给定时器赋初值，定时1ms
 153          ////  TL1=0X18;
 154          //////  count_num++;
 155          ////}
 156          
 157          /*******************************************************************************
 158          * 函数名         : Usart() interrupt 4
 159          * 函数功能      : 串口通信中断函数
 160          * 输入           : 无
 161          * 输出           : 无
 162          *******************************************************************************/
 163          //void Usart() interrupt 4
 164          //{
 165          //  u8 receiveData;
 166          //  receiveData=SBUF;   //出去接收到的数据
 167          //  RI = 0;             //清除接收中断标志位
 168          //  SBUF=receiveData;   //将接收到的数据放入到发送寄存器
 169          //  while(!TI);         //等待发送数据完成
 170          //  TI=0;               //清除发送完成标志位
 171          //}


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    125    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
C51 COMPILER V9.00   INTERRUPT                                                             12/28/2017 15:24:07 PAGE 4   

   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
